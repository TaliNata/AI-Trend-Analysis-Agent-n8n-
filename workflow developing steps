## Подход к разработке

Проект развивался итеративно, как реальный production-пайплайн.

### Этап 1. Проектирование структуры

- Сначала была выстроена полная схема workflow в n8n
- Все ноды были добавлены пустыми, без логики
- Проверена корректность порядка шагов и потоков данных
- Отделены вычислительные этапы от бизнес-логики и LLM

Цель этапа — архитектурная целостность, а не код.

---

### Этап 2. Настройка и конфигурация нод

- Настроен общий `Config`-блок для параметров анализа
- Реализованы входные триггеры (Cron)
- Добавлена нормализация входных данных
- Подготовлены заготовки для аналитических узлов

---

### Этап 3. Реализация логики анализа (MVP)

Пошагово были добавлены и протестированы:

- Извлечение сигналов (bigrams вместо одиночных слов)
- Time-series анализ (сравнение текущего и предыдущего периодов)
- Классификация сигналов (trend / spike / noise)
- Оценка устойчивости трендов (emerging / stable / volatile)
- Явное разделение:
  - расчётов
  - классификации
  - фильтрации (через IF, а не через уничтожение данных)

На этом этапе был достигнут рабочий MVP, корректно отличающий шум от сигналов.

---

### Этап 4. Оптимизация под LLM

- Добавлено ограничение `top-N` трендов
- LLM вынесен в конец пайплайна
- Используется батч-анализ вместо множества вызовов
- Введён строгий контракт user + system prompt
- Добавлен post-filter для защиты от нестабильного вывода моделей

Цель — контролируемое и экономичное использование LLM.

---

### Этап 5. Подключение внешних сервисов

После стабилизации логики были добавлены:

- Источник новостей (News Trends / News API)
- Интеграция с Telegram (уведомления / дайджесты)
- Интеграция с Notion (логирование и хранение результатов)
